<!DOCTYPE html>
<html>
<body>
    <h2>The Notes Project: Submitter</h2>
    <input type="text" id="vrcCode" placeholder="Paste Code from VRChat">
    <textarea id="noteContent" placeholder="Your message..."></textarea>
    <button onclick="submitNote()">Post Note</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = { databaseURL: "https://the-notes-project-76941-default-rtdb.firebaseio.com/" };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.submitNote = function() {
            const raw = document.getElementById('vrcCode').value.split('|');
            if(raw.length < 5) return alert("Invalid Code");

            const [name, x, y, z, check] = raw;
            const content = document.getElementById('noteContent').value;

            // This path 'notes/Username' ensures one note per player (overwrites old ones)
            set(ref(db, 'notes/' + name), {
                user: name,
                x: parseFloat(x),
                y: parseFloat(y),
                z: parseFloat(z),
                text: content,
                time: Date.now()
            }).then(() => alert("Note Placed!"));
        }
    </script>
</body>
</html>
